<!doctype html>
<html lang="ja">
	<head>
		<meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/choir.css">
    <link rel="icon" type="image/png" sizes="16x16" href="/img/favicon.ico">
		<script src="/js/get_mp3.js"></script>
    <script src="/js/get_information.js"></script>
    <script src="/js/svgPiano.js"></script>
    <script src="/js/howler.core.js"></script>
    <script src="https://unpkg.com/@tonejs/midi"></script>
    <script type='text/javascript'>
      const mp3Files = {
        "soprano"     : '/christmas/Celebrate-the-King/2-01 Celebrate-the-King (soprano2).mp3',
        "alto"        : '/christmas/Celebrate-the-King/2-02 Celebrate-the-King (alto2).mp3',
        "tenor"       : '/christmas/Celebrate-the-King/2-03 Celebrate-the-King (tenor2).mp3',
        "bass"        : '/christmas/Celebrate-the-King/2-04 Celebrate-the-King (bass2).mp3',
        "full"        : '/christmas/Celebrate-the-King/Celebrate-the-King.mp3',
        "vcl_soprano" : '/christmas/Celebrate-the-King/2-01 Celebrate-the-King (vcl_soprano).mp3',
        "vcl_alto"    : '/christmas/Celebrate-the-King/2-02 Celebrate-the-King (vcl_alto).mp3',
        "vcl_tenor"   : '/christmas/Celebrate-the-King/2-03 Celebrate-the-King (vcl_tenor).mp3',
        "vcl_bass"    : '/christmas/Celebrate-the-King/2-04 Celebrate-the-King (vcl_bass).mp3',
        "vcl_full"    : '/christmas/Celebrate-the-King/2-05 Celebrate-the-King (vcl_full).mp3'
      };
      const midiFiles = {
        soprano: ['/christmas/Celebrate-the-King/Celebrate-the-King.mid',0],
        alto: ['/christmas/Celebrate-the-King/Celebrate-the-King.mid',1],
        tenor: ['/christmas/Celebrate-the-King/Celebrate-the-King.mid',2],
        bass: ['/christmas/Celebrate-the-King/Celebrate-the-King.mid',3],
        full: ['/christmas/Celebrate-the-King/Celebrate-the-King.mid',[0,1,2,3]]
      };
      const ranges = {
        main: {
            'A':'0.5,53.8',
            'A2':'42,53.8',
            'B':'53.6,84.5',
            'C':'83.3,116',
            'D':'116,137.2',
            'E':'137,174',
            'F':'174,203'
         },
        vcl: {
            'A':'0.5,51.7',
            'A2':'40.5,51.7',
            'B':'51.6,80.5',
            'C':'80.5,112',
            'D':'111.5,134',
            'E':'134,169.9',
            'F':'169.9,197'
          }
        }
		</script>
	  <style type="text/css">
      div.audio-container {
        height: 30px;
        width: 400px;
        display: flex;
        flex-direction: row;
        align-items: center;
        margin-bottom: 10px;
        gap: 5px
      }
      span.timeDisplay {
        width: auto;
        font-size: 12px;
        text-wrap: nowrap;
      }
      div.segment-btn-container {
        width: auto;
        display: block;
        margin-bottom: 10px;
      }
      div.segment-btn-container button {
        width: auto;
        height: 1.6em;
        margin-right: 5px;
      }
      li {height: auto;}
      li div {width: "";}
    </style>

    <title>'Celebrate the King'パート別練習用音源</title>
	</head>
	<body>
<div class="body">
<h1>パート別練習用音源</h1>

<div class='nen'>
  <h4>Celebrate the King (ヘンデルメドレー)</h4>
  <ul style="list-style: none;">
    <li>
      <div class="part">ソプラノ</div>
      <div class="audio-container" name="soprano"></div>
      <div class="segment-btn-container" name="soprano">
        <button class="playBtn" name='main,A'>A もろびと、世に下りし御子を</button>
        <button class="playBtn" name='main,A2'>(アレルヤ~平和の君をたたえよ)</button>
        <button class="playBtn" name='main,B'>B みつかいたちの</button>
        <button class="playBtn" name='main,C'>C グローリア</button>
        <button class="playBtn" name='main,D'>D いそぎゆきて</button>
        <button class="playBtn" name='main,E'>E あーたれも聞け</button>
        <button class="playBtn" name='main,F'>F ノエル</button>
      </div>
      <div class="vcl">AI Vocal</div>
      <div class="audio-container" name="vcl_soprano"></div>
      <div class="segment-btn-container" name="vcl_soprano">
        <button class="playBtn" name='vcl,A'>A もろびと、世に下りし御子を</button>
        <button class="playBtn" name='vcl,A2'>(アレルヤ~平和の君をたたえよ)</button>
        <button class="playBtn" name='vcl,B'>B みつかいたちの</button>
        <button class="playBtn" name='vcl,C'>C グローリア</button>
        <button class="playBtn" name='vcl,D'>D いそぎゆきて</button>
        <button class="playBtn" name='vcl,E'>E あーたれも聞け</button>
        <button class="playBtn" name='vcl,F'>F ノエル</button>
      </div>
    </li>
    <li>
      <div class="part">アルト</div>
      <div class="audio-container" name="alto"></div>
      <div class="segment-btn-container" name="alto">
        <button class="playBtn" name='main,A'>A もろびと、世に下りし御子を</button>
        <button class="playBtn" name='main,A2'>(アレルヤ~平和の君をたたえよ)</button>
        <button class="playBtn" name='main,B'>B みつかいたちの</button>
        <button class="playBtn" name='main,C'>C グローリア</button>
        <button class="playBtn" name='main,D'>D いそぎゆきて</button>
        <button class="playBtn" name='main,E'>E あーたれも聞け</button>
        <button class="playBtn" name='main,F'>F ノエル</button>
      </div>
      <div class="vcl">AI Vocal</div>
      <div class="audio-container" name="vcl_alto"></div>
      <div class="segment-btn-container" name="vcl_alto">
        <button class="playBtn" name='vcl,A'>A もろびと、世に下りし御子を</button>
        <button class="playBtn" name='vcl,A2'>(アレルヤ~平和の君をたたえよ)</button>
        <button class="playBtn" name='vcl,B'>B みつかいたちの</button>
        <button class="playBtn" name='vcl,C'>C グローリア</button>
        <button class="playBtn" name='vcl,D'>D いそぎゆきて</button>
        <button class="playBtn" name='vcl,E'>E あーたれも聞け</button>
        <button class="playBtn" name='vcl,F'>F ノエル</button>
      </div>
    </li>
    <li>
      <div class="part">テノール</div>
      <div class="audio-container" name="tenor"></div>
      <div class="segment-btn-container" name="tenor">
        <button class="playBtn" name='main,A'>A もろびと、世に下りし御子を</button>
        <button class="playBtn" name='main,A2'>(アレルヤ~平和の君をたたえよ)</button>
        <button class="playBtn" name='main,B'>B みつかいたちの</button>
        <button class="playBtn" name='main,C'>C グローリア</button>
        <button class="playBtn" name='main,D'>D いそぎゆきて</button>
        <button class="playBtn" name='main,E'>E あーたれも聞け</button>
        <button class="playBtn" name='main,F'>F ノエル</button>
      </div>
      <div class="vcl">AI Vocal</div>
      <div class="audio-container" name="vcl_tenor"></div>
      <div class="segment-btn-container" name="vcl_tenor">
        <button class="playBtn" name='vcl,A'>A もろびと、世に下りし御子を</button>
        <button class="playBtn" name='vcl,A2'>(アレルヤ~平和の君をたたえよ)</button>
        <button class="playBtn" name='vcl,B'>B みつかいたちの</button>
        <button class="playBtn" name='vcl,C'>C グローリア</button>
        <button class="playBtn" name='vcl,D'>D いそぎゆきて</button>
        <button class="playBtn" name='vcl,E'>E あーたれも聞け</button>
        <button class="playBtn" name='vcl,F'>F ノエル</button>
      </div>
    </li>
    <li>
      <div class="part">バス</div>
      <div class="audio-container" name="bass"></div>
      <div class="segment-btn-container" name="bass">
        <button class="playBtn" name='main,A'>A もろびと、世に下りし御子を</button>
        <button class="playBtn" name='main,A2'>(アレルヤ~平和の君をたたえよ)</button>
        <button class="playBtn" name='main,B'>B みつかいたちの</button>
        <button class="playBtn" name='main,C'>C グローリア</button>
        <button class="playBtn" name='main,D'>D いそぎゆきて</button>
        <button class="playBtn" name='main,E'>E あーたれも聞け</button>
        <button class="playBtn" name='main,F'>F ノエル</button>
      </div>
      <div class="vcl">AI Vocal</div>
      <div class="audio-container" name="vcl_bass"></div>
      <div class="segment-btn-container" name="vcl_bass">
        <button class="playBtn" name='vcl,A'>A もろびと、世に下りし御子を</button>
        <button class="playBtn" name='vcl,A2'>(アレルヤ~平和の君をたたえよ)</button>
        <button class="playBtn" name='vcl,B'>B みつかいたちの</button>
        <button class="playBtn" name='vcl,C'>C グローリア</button>
        <button class="playBtn" name='vcl,D'>D いそぎゆきて</button>
        <button class="playBtn" name='vcl,E'>E あーたれも聞け</button>
        <button class="playBtn" name='vcl,F'>F ノエル</button>
      </div>
    </li>
    <li>
      <div class="part">コーラス</div>
      <div class="audio-container" name="full"></div>
      <div class="segment-btn-container" name="full">
        <button class="playBtn" name='main,A'>A もろびと、世に下りし御子を</button>
        <button class="playBtn" name='main,A2'>(アレルヤ~平和の君をたたえよ)</button>
        <button class="playBtn" name='main,B'>B みつかいたちの</button>
        <button class="playBtn" name='main,C'>C グローリア</button>
        <button class="playBtn" name='main,D'>D いそぎゆきて</button>
        <button class="playBtn" name='main,E'>E あーたれも聞け</button>
        <button class="playBtn" name='main,F'>F ノエル</button>
      </div>
      <div class="vcl">AI Vocal</div>
      <div class="audio-container" name="vcl_full"></div>
      <div class="segment-btn-container" name="vcl_full">
        <button class="playBtn" name='vcl,A'>A もろびと、世に下りし御子を</button>
        <button class="playBtn" name='vcl,A2'>(アレルヤ~平和の君をたたえよ)</button>
        <button class="playBtn" name='vcl,B'>B みつかいたちの</button>
        <button class="playBtn" name='vcl,C'>C グローリア</button>
        <button class="playBtn" name='vcl,D'>D いそぎゆきて</button>
        <button class="playBtn" name='vcl,E'>E あーたれも聞け</button>
        <button class="playBtn" name='vcl,F'>F ノエル</button>
      </div>
    </li>
  </ul>
</div>
<div id="piano-container"></div>
<div class='nen'>
  <ul style="list-style: none;">
    <li>
      <div class="part"><a href='#' onclick="plus_password('./Celebrate-the-King.pdf')">楽譜</a></div>
    </li>
  </ul>
</div>
<div class='link'>
  <a href='../The First Noel/The First Noel.html'>⇒The First Noelの音源へ</a>
  <br>
  <a href='/mcc/index.html'>⇒ MCCワーシップクワイアーの持ち歌のページに戻る.</a>
</div>

</div>
<script>
  const svgPiano = new SvgPiano(
    'piano-container',
    {
        min_key_number: 39,
        number_of_white_keys: 28,
        white_key_width: 30,
        white_key_height: 120,
        black_key_width: 24,
        black_key_height: 70,
        volume: 0.5
    }
  );

  // パート別に play,pause,stopの各ボタン、seekBar,timeDisplay を作成
  const audioControls = setAudioControls(".audio-container");

  // audioControlインスタンスに、svgPiano,midiファイル,mp3ファイル等を設定
  audioControls.forEach(audioControl => {
    const name = audioControl.options.name;
    audioControl.update({
      svgPiano: svgPiano,
      mp3File: mp3Files[name],
      midiFile: midiFiles[name.replace('vcl_', '')][0],
      trackIndex: midiFiles[name.replace('vcl_', '')][1],
    });
  });

  document.querySelectorAll(".playBtn").forEach(btn => {
    btn.addEventListener("click", function() {
      const name = btn.parentNode.getAttribute("name");
      //const name = "segment-" + parentName;
      const [part,segment] = btn.getAttribute("name").split(",");
      const range = ranges[part][segment];
      const [start,end] = range.split(",");
      console.log(`start,end => ${start},${end}`);
      
      const audioControl = audioControls.find(control => control.options.name === name );
      audioControl.update({ segment: range })

      if (Number(start) < audioControl.seekBar.value) {
        audioControl.playSegment(audioControl.seekBar.value, Number(end));
      } else {
        audioControl.playSegment();
      }
    });
  });

  let ac = audioControls.find(control => control.options.name === "soprano" );
  //alert(ac.options.midiFile);
</script>
	</body>
</html>